---
layout: post
title: 后端微服务文档
description: 本章内容为后端服务手册。
category: 工作流
date: 2017-12-02
list_number: false
---

## [租户](#租户)

### [租户列表](#租户列表)
服务地址：
```
./microservice/workflownew/s/useSession/showTenantList?count=1&name=一
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `count`  | 页数 | int | 是 |
| `name`  | 租户名称 | String | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"RetVal":null,
	"maxPageNum":1,
	"pageItems":[
		{
			"activated":true,
			"code":"tenant11",
			"companyName":null,
			"createTime":1550628600000,
			"dataSourceConfig":null,
			"description":"这是第十一个租户",
			"id":"tb",
			"invite":[],
			"name":"租户二一",
			"tenantAccBuk":[]
		}
	],
	"pageNo":1,
	"pageSize":9,
	"totalCount":1
}
```

说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | <font color='red'>取值为0/1/2/3，其中1为正常，其它情况均为异常</font> |
| `RetVal` | <font color='red'>发生异常时的简单介绍</font> |
| `maxPageNum` | 最大页数 |
| `pageItems` | 页内容 |
| `pageNo` | 当前页码 |
| `pageSize` | 每页容量 |
| `totalCount` | 全部数量 |
| `activated`  | 是否启用，可能的返回值“true/false”，true 代表启用，false 代表禁用|
| `code` | 租户编码 |
| `companyName` | 不用管 |
| `createTime`     | 建立时间 |
| `dataSourceConfig`     | 不用管 |
| `description`     | 租户描述 |
| `id`     | 主键，独一无二 |
| `invite`  | 不用管 |
| `name`     | 租户名称 |
| `tenantAccBuk`     | 不用管 |

### [租户数据源信息](#租户数据源信息)
服务地址：
```
./microservice/workflownew/s/useSession/showTenantSource?tenantId=t1
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |
<b>需要登录</b>

返回结果如下：

```
{
	"DataRows":{
		"code":"tenant2",
		"dataSourceConfig":{
			"minIdle":"1",
			"validationQuery":"select 1",
			"initialSize":"1",
			"maxWait":"60000",
			"filters":"stat",
			"poolPreparedStatements":"true",
			"type":"com.alibaba.druid.pool.DruidDataSource",
			"url":"jdbc:mysql://10.0.209.144:3306/myactiviti?useSSL=false",
			"useSSL":"false",
			"testWhileIdle":"true",
			"testOnBorrow":"false",
			"maxOpenPreparedStatements":"20",
			"timeBetweenEvictionRunsMillis":"60000",
			"minEvictableIdleTimeMillis":"300000",
			"testOnReturn":"false",
			"name":"testdb3",
			"maxActive":"20"
		},
		"id":"t12",
		"invite":[],
		"name":"租户一二",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":null
}
```

说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 具体内容 |
| `code` | 租户编码 |
| `id`     | 主键，独一无二 |
| `invite`  | 不用管 |
| `name`     | 租户名称 |
| `tenantAccBuk`     | 不用管 |
| `dataSourceConfig` | 数据源内容，内部属性不固定，按key和value的方式展示 |

### [新建租户基本信息](#新建租户基本信息)
服务地址：
```
./microservice/workflownew/s/useSession/createTenantBasic?name=n&code=c&description=d&activated=true
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `name`  | 租户名称 | String | 是 |
| `code`  | 租户编号，需异步调用校验 | String | 是 |
| `description`  | 租户描述 | String | 是 |
| `activated`  | 是否启用，可接受true/false/1/0 | boolean | 是 |
<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"DataRows":{
		"activated":true,
		"code":"a26",
		"createTime":1551357397690,
		"description":"asd",
		"id":"5800f1526a444a269620e7bb64fbb775",
		"invite":[],
		"name":"新7",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":"租户 新7:a26 新增成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"租户 新7:a26 新增时发生异常：FindRepeatedTenantCode"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 正常时返回新增租户信息 |
| `code` | 租户编码 |
| `id`     | 租户主键，独一无二 |
| `name`     | 租户名称 |
| `createTime`     | 创建时间 |

### [检查租户编号是否可用](#检查租户编号是否可用)
服务地址：
```
./microservice/workflownew/s/useSession/checkTenantCode?code=aa&tenantId=t1
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `code`  | 租户编号 | String | 是 |
| `tenantId`  | <font color='red'>租户id，如果提供则在检查时排除此tenantId</font> | String | 否 |

<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"RetCode":"1",
	"RetVal":""
}
失败时：
{
	"RetCode":"2",
	"RetVal":"租户编号已被使用"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |

### [新建租户数据源信息](#新建租户数据源信息)
服务地址（在浏览器上访问需要将 `{` 和 `}` 转义为 `%7B` 和 `%7D` ）：
```
./microservice/workflownew/s/useSession/createTenantDataSource?tenantId=t2&dataSourceConfig={"a1":"b1","a2":"b2","username":"a","password":"ss"}
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |
| `dataSourceConfig`  | 数据源配置 | JSON | 是 |
| `createSchemaAndTable`  | 是否建库并初始化表结构 | boolean | 否 |
<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"DataRows":{
		"activated":false,
		"code":"a25",
		"createTime":1551357279000,
		"dataSourceConfig":{
			"a1":"b1",
			"a2":"b2"
		},
		"description":"asd2",
		"id":"t2",
		"invite":[],
		"name":"新7",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":"租户 新7:a25 数据源增加成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"失败原因XXX"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |

### [删除租户](#删除租户)
服务地址：
```
./microservice/workflownew/s/useSession/disableTenant?tenantId=t1
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |
<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"DataRows":{
		"activated":false,
		"code":"xxx",
		"createTime":1551777955000,
		"description":"",
		"enabled":false,
		"id":"t1",
		"invite":[],
		"name":"XXX",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":"相关租户删除成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"失败原因XXX"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `enabled` | 是否存在，可能的返回值“true/false”，true 代表存在，false 代表删除 |

### [展示租户内人员](#展示租户内人员)
```
./microservice/workflownew/s/useSession/showTenantStaffList?count=1&pageSize=10&tenantId=t3&role=b&name=bob
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `count`  | 页数 | int | 是 |
| `pageSize`  | 每页显示数量 | int | 是 |
| `tenantId`  | 租户id | String | 是 |
| `name`  | 人员名称，模糊匹配 | String | 否 |
| `role`  | 人员在租户中的角色，a：管理员；b：成员；c：创建者 | String | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"accountBucket":{
				"actReModel":[],
				"actReProcdef":[],
				"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
				"id":"eea3867639c14820a77eb6a58abc3627",
				"invite":[],
				"name":"bob",
				"temp":"bob@test.org",
				"tenantAccBuk":[{"$ref":"$.pageItems[0]"}],
				"unreadNotifyCount":0
			},
			"id":"16521897910988804",
			"status":"成员",
			"tenant":{
				"activated":true,
				"code":"tenant3",
				"createTime":1550628120000,
				"description":"这是第三个租户",
				"enabled":true,
				"id":"t3",
				"invite":[],
				"name":"天宫",
				"tenantAccBuk":[{"$ref":"$.pageItems[0]"}]
			}
		}
	],
	"pageNo":1,
	"pageSize":10,
	"totalCount":1
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `maxPageNum` | 最大页数 |
| `pageItems` | 页内容 |
| `pageNo` | 当前页码 |
| `pageSize` | 每页容量 |
| `totalCount` | 全部数量 |
| `status` | 人员在租户内角色。a：管理员；b：成员；c：创建者 |
| `tenant` | 租户信息 |
| `accountBucket` | 租户中人员信息 |
|  | 以下为`accountBucket`中信息 |
| `actReModel`     | 不用管 |
| `actReProcdef`     | 不用管 |
| `avatar` | 人员avatar |
| `id` | 人员id，独一无二 |
| `invite` | 不用管 |
| `name` | 人员姓名 |
| `temp` | 人员邮箱 |
| `tenantAccBuk` | 不用管 |
| `unreadNotifyCount` | 不用管 |

### [按邮箱开头匹配人员](#按邮箱开头匹配人员)
服务地址：
```
./microservice/workflownew/s/useSession/headMatchEmail?emailHead=lim&pageSize=1&tenantId=t3
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `emailHead`  | 邮箱地址开头 | String | 是 |
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `tenantId`  | 租户id，若提供则优先在此租户内查找 | String | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"DataRows":[
		{
			"account":{
				"accountBucket":[{"$ref":"$.DataRows[0]"}],
				"accountRole":[],
				"activated":true,
				"email":"limeng32@live6.cn",
				"id":"5c97a93c0d184b4a956e9bd10e439b7e",
				"loginlog":[],
				"name":"limeng32",
				"resetPasswordLog":[],
				"status":"a"
			},
			"actReModel":[],
			"actReProcdef":[],
			"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
			"id":"0e8505a65f08492f91b2d7a3785b26b1",
			"invite":[],
			"name":"limeng32",
			"temp":false,
			"tenantAccBuk":[],
			"unreadNotifyCount":0
		}
	],
	"RetCode":"1"
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `DataRows` | 返回的用户信息 |
| `temp` | 若调用时提供租户id且人员属于此租户则返回true，其它情况返回false |

### [将人员添加到租户](#将人员添加到租户)
```
./microservice/workflownew/s/useSession/addTenantStaff?accBukId=eea3867639c14820a77eb6a58abc3624&tenantId=0e3e2d562958469db47ede6ae5b29520&status=b
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `accBukId`  | 人员id | String | 是 |
| `tenantId`  | 租户id | String | 是 |
| `status`  | 人员在租户内角色。a：管理员；b：成员；c：创建者 | String | 是 |

<b>需要登录</b>

返回结果如下：

```json
成功时：
{
	"DataRows":{
		"accountBucket":{
			"actReModel":[],
			"actReProcdef":[],
			"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
			"id":"eea3867639c14820a77eb6a58abc3624",
			"invite":[],
			"name":"李萌",
			"tenantAccBuk":[{"$ref":"$.DataRows"}],
			"unreadNotifyCount":0
		},
		"id":"25685346922524672",
		"tenant":{
			"activated":true,
			"code":"ererer",
			"createTime":1552274028000,
			"description":"sadf",
			"enabled":true,
			"id":"ab8a4eb8e22741859a137841e43f92a3",
			"invite":[],
			"name":"尔尔",
			"tenantAccBuk":[{"$ref":"$.DataRows"}]
		}
	},
	"RetCode":"1",
	"RetVal":"用户与租户关联成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"人员和租户已存在关联关系"
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 返回的用户信息 |

### [编辑租户基本信息](#编辑租户基本信息)
```
./microservice/workflownew/s/useSession/editTenantBasic?tenantId=t1&name=n&code=c&description=d&activated=true
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |
| `name`  | 租户名称 | String | 是 |
| `code`  | 租户编号，需异步调用校验 | String | 是 |
| `description`  | 租户描述 | String | 是 |
| `activated`  | 是否启用，可接受true/false/1/0 | String | 是 |

<b>需要登录</b>

返回结果如下：

```json
成功时：
{
	"DataRows":{
		"activated":true,
		"code":"c",
		"createTime":1550628000000,
		"dataSourceConfig":{
			"minIdle":"1",
			"validationQuery":"select 1",
			"initialSize":"1",
			"maxWait":"60000",
			"filters":"stat",
			"poolPreparedStatements":"true",
			"type":"com.alibaba.druid.pool.DruidDataSource",
			"url":"jdbc:mysql://10.0.209.148:3306/myactiviti_test?useUnicode=true",
			"useSSL":"false",
			"testWhileIdle":"true",
			"testOnBorrow":"false",
			"maxOpenPreparedStatements":"20",
			"timeBetweenEvictionRunsMillis":"60000",
			"minEvictableIdleTimeMillis":"300000",
			"testOnReturn":"false",
			"name":"testdb3",
			"maxActive":"20"
		},
		"description":"d",
		"enabled":true,
		"id":"t1",
		"invite":[],
		"name":"n",
		"tenantAccBuk":[],
		"updateTime":1552908455906
	},
	"RetCode":"1",
	"RetVal":"租户 n:c 更新成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"失败原因XXX"
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 返回的用户信息 |

### [编辑租户的数据源配置](#编辑租户的数据源配置)
服务地址（在浏览器上访问需要将 `{` 和 `}` 转义为 `%7B` 和 `%7D` ）：
```
./microservice/workflownew/s/useSession/editTenantDataSource?tenantId=t2&dataSourceConfig={"a1":"b1","a2":"b2","username":"a","password":"ss"}
```
其余内容与 [新建租户数据源信息](#新建租户数据源信息) 完全相同

### [取消租户和人员关联](#取消租户和人员关联)
```
./microservice/workflownew/s/useSession/deleteTenantAccBuk?tenantAccBukId=27806925081014272
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantAccBukId`  | 租户与人员关系id | String | 是 |

<b>需要登录</b>

返回结果如下：

```json
成功时：
{
	"DataRows":{
		"accountBucket":{
			"actReModel":[],
			"actReProcdef":[],
			"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
			"id":"eea3867639c14820a77eb6a58abc3624",
			"invite":[],
			"name":"李萌",
			"tenantAccBuk":[{"$ref":"$.DataRows"}],
			"unreadNotifyCount":0
		},
		"id":"27806925081014272",
		"status":"创建者",
		"tenant":{
			"activated":true,
			"code":"asd",
			"createTime":1552901687000,
			"description":"",
			"enabled":true,
			"id":"3bc61dc67eef4f51a955de2aa30e5f97",
			"invite":[],
			"name":"asd2",
			"tenantAccBuk":[{"$ref":"$.DataRows"}],
			"updateTime":1552901687000
		}
	},
	"RetCode":"1",
	"RetVal":"人员 李萌 已不在租户 asd2 中"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"租户和人员无关联关系"
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 返回的用户信息 |

### [查询单个租户基本信息](#查询单个租户基本信息)
```
./microservice/workflownew/s/useSession/showTenant?tenantId=t3
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |

<b>需要登录</b>

返回结果如下：

```json
成功时：
{
	"DataRows":{
		"activated":true,
		"code":"tenant3",
		"createTime":1550628120000,
		"description":"这是第31个租户",
		"enabled":true,
		"id":"t3",
		"invite":[],
		"name":"天宫",
		"tenantAccBuk":[],
		"updateTime":1550628120000
	},
	"RetCode":"1"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"无法找到租户"
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 返回的用户信息 |

### [查询单个租户健康情况](#查询单个租户健康情况)
```
./microservice/workflownew/s/useSession/checkTenantHealth?tenantId=t3
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |

<b>需要登录</b>

返回结果如下：

```json
运行正常时：
{
	"DataRows":true,
	"RetCode":"1"
}
运行异常时：
{
	"DataRows":false,
	"RetCode":"1"
}
或不返回信息
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为1 |
| `DataRows` | 正常时返回true，异常时返回false |

## [我的工作台](#我的工作台)

### [流程实例动态](#流程实例动态)
```
./microservice/workflownew/s/useSession/showProcTrends?pageSize=10&count=1&procInstId=49067832205373440
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
| `procInstId`  | 查询流程实例id | long | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1451,
	"pageItems":[
		{
			"actHiProcinst":{
				"actHiActinst":[{"$ref":"$.pageItems[0]"}],
				"actHiComment":[],
				"actHiTaskinst":[],
				"actHiVarinst":[],
				"id":"49067832205373440",
				"procDefId":"regulationPublish:35:222177",
				"procInstId":"49067832205373440",
				"startActId":"sid-6B72DFC5-10FA-4F13-88F7-252B517E0D55",
				"startTime":1557970682833,
				"tenantId":"eea3867639c14820a77eb6a58abc3624"
			},
			"actId":"checking",
			"actName":"审核规章制度",
			"actType":"userTask",
			"executionId":"49067832205373440",
			"id":"49067833304281089",
			"startTime":1557970683095,
			"tenant":{
				"actReModel":[],
				"actReProcdef":[],
				"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
				"id":"eea3867639c14820a77eb6a58abc3624",
				"invite":[],
				"name":"李萌",
				"tenantAccBuk":[],
				"unreadNotifyCount":0
			},
			"tenantId":"eea3867639c14820a77eb6a58abc3624"
		}
	],
	"pageNo":1,
	"pageSize":1,
	"totalCount":1451
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `tenant.name` | 流程拥有者 |
| `procDefId` | 流程定义id |
| `procInstId` | 流程实例id |
| `actName` | 当前环节名 |
| `startTime` | 当前环节开始时间 |

### [流程实例历史](#流程实例历史)
```
./microservice/workflownew/s/useSession/showProcHistory?pageSize=10&count=1&procInstId=33559415449710592
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
| `procInstId`  | 查询流程实例id | long | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":243,
	"pageItems":[
		{
			"actHiActinst":[],
			"actHiComment":[],
			"actHiTaskinst":[],
			"actHiVarinst":[],
			"duration":"30",
			"endActId":"sid-7FACEE80-094D-4482-8C43-D58E92941008",
			"endTime":1554274941469,
			"id":"33566769280970752",
			"procDefId":"coool:3:31833552035246080",
			"procInstId":"33566769280970752",
			"startActId":"sid-0994B79C-0F10-46CD-B0AB-70445DD5AF36",
			"startTime":1554274941439,
			"tenant":{
				"actReModel":[],
				"actReProcdef":[],
				"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
				"id":"eea3867639c14820a77eb6a58abc3624",
				"invite":[],
				"name":"李萌1",
				"tenantAccBuk":[],
				"unreadNotifyCount":0
			},
			"tenantId":"eea3867639c14820a77eb6a58abc3624"
		},
		{
			"actHiActinst":[],
			"actHiComment":[],
			"actHiTaskinst":[],
			"actHiVarinst":[],
			"duration":"26",
			"endActId":"sid-7FACEE80-094D-4482-8C43-D58E92941008",
			"endTime":1554273188178,
			"id":"33559415449710592",
			"procDefId":"coool:3:31833552035246080",
			"procInstId":"33559415449710592",
			"startActId":"sid-0994B79C-0F10-46CD-B0AB-70445DD5AF36",
			"startTime":1554273188152,
			"tenant":{"$ref":"$.pageItems[0].tenant"},
			"tenantId":"eea3867639c14820a77eb6a58abc3624"
		}
	],
	"pageNo":1,
	"pageSize":2,
	"totalCount":485
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `tenant.name` | 流程拥有者 |
| `procDefId` | 流程定义id |
| `procInstId` | 流程实例id |
| `endTime` | 流程结束时间 |

### [查询用户关注的流程](#查询用户关注的流程)
```
./microservice/workflownew/s/useSession/showMyCaredProcdef
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"accountBucket":{
				"accBukCared":[{"$ref":"$.pageItems[0]"}],
				"accountId":"ca9a8d8885944af9b254e023d67ee2df",
				"actReModel":[],
				"actReProcdef":[],
				"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
				"id":"b33d221d066e498881ad2086d897ffdd",
				"invite":[],
				"name":"lm32live",
				"tenantAccBuk":[],
				"unreadNotifyCount":0
			},
			"actReModel":{
				"accBukCared":[{"$ref":"$.pageItems[0]"}],
				"actReProcdef":[{
					"actHiActinst":[],
					"actHiProcinst":[],
					"actHiTaskinst":[],
					"actReModel":{"$ref":"$.pageItems[0].actReModel"},
					"actRuExecution":[],
					"actRuTask":[],
					"category":"http://activiti.org/test",
					"deploymentId":"79655050686754816",
					"deploymentTime":1565263244048,
					"dgrmResourceName":"qqq.a.png",
					"hasGraphicalNotation":true,
					"hasStartFormKey":false,
					"id":"a:1:79655050850332672",
					"key":"a",
					"modelId":"18046977115680768",
					"modelRev":6,
					"resourceName":"qqq.bpmn20.xml",
					"rev":2,
					"suspensionState":1,
					"tenantId":"b33d221d066e498881ad2086d897ffdd",
					"version":1
				}],
				"business_id":"qqqq",
				"createTime":1550574734639,
				"editorSourceExtraValueId":"79654995695235072",
				"editorSourceValueId":"18046977170206720",
				"id":"18046977115680768",
				"lastUpdateTime":1565263249937,
				"latestDeployRev":6,
				"metaInfo":"{\"name\":\"qqq\",\"description\":\"\"}",
				"name":"qqq",
				"rev":7,
				"tenantId":"b33d221d066e498881ad2086d897ffdd",
				"version":1
			},
			"id":"221",
			"modelId":"18046977115680768",
			"tenantCode":"test"
		}
	],
	"pageNo":1,
	"pageSize":6,
	"totalCount":1
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `actReModel.actReProcdef[0].key` | 流程名称 |
| `actReModel.metaInfo.description` | 流程描述 |
| `actReModel.actReProcdef[0].version` | 流程版本 |
| `actReModel.actReProcdef[0].deploymentTime` | 上次部署时间 |

### [查询用户拥有的流程](#查询用户拥有的流程)
```
./microservice/workflownew/s/useSession/showMyOwnedProcdef
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"actHiActinst":[],
			"actHiProcinst":[],
			"actHiTaskinst":[],
			"actRuExecution":[],
			"actRuTask":[],
			"category":"http://activiti.org/test",
			"deploymentId":"79892507487367168",
			"deploymentTime":1565319858395,
			"dgrmResourceName":"qqq.aaaaaaaaaaaaaaa.png",
			"hasGraphicalNotation":true,
			"hasStartFormKey":false,
			"id":"aaaaaaaaaaaaaaa:5:79892507898408960",
			"key":"aaaaaaaaaaaaaaa",
			"modelId":"18046977115680768",
			"modelRev":14,
			"resourceName":"qqq.bpmn20.xml",
			"rev":2,
			"suspensionState":1,
			"tenantId":"b33d221d066e498881ad2086d897ffdd",
			"version":5
		}
	],
	"pageNo":1,
	"pageSize":10000,
	"totalCount":1
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `id` | 穿梭窗上显示用 |
| `modelId` | 唯一标识 |

### [查询我关注的流程下的所有实例](#查询我关注的流程下的所有实例)
```
./microservice/workflownew/s/useSession/showMyCaredProcAll
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `modelId`  | 流程对应模型的id | long | 是 |
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
| `procInstId`  | 查询流程实例id | long | 否 |
<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1451,
	"pageItems":[
		{
			"actHiProcinst":{
				"actHiActinst":[{"$ref":"$.pageItems[0]"}],
				"actHiComment":[],
				"actHiTaskinst":[],
				"actHiVarinst":[],
				"id":"49067832205373440",
				"procDefId":"regulationPublish:35:222177",
				"procInstId":"49067832205373440",
				"startActId":"sid-6B72DFC5-10FA-4F13-88F7-252B517E0D55",
				"startTime":1557970682833,
				"tenantId":"eea3867639c14820a77eb6a58abc3624"
			},
			"actId":"checking",
			"actName":"审核规章制度",
			"actType":"userTask",
			"executionId":"49067832205373440",
			"id":"49067833304281089",
			"startTime":1557970683095,
			"tenant":{
				"actReModel":[],
				"actReProcdef":[],
				"avatar":"https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png",
				"id":"eea3867639c14820a77eb6a58abc3624",
				"invite":[],
				"name":"李萌",
				"tenantAccBuk":[],
				"unreadNotifyCount":0
			},
			"tenantId":"eea3867639c14820a77eb6a58abc3624"
		}
	],
	"pageNo":1,
	"pageSize":1,
	"totalCount":1451
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `tenant.name` | 流程拥有者 |
| `procDefId` | 流程定义id |
| `procInstId` | 流程实例id |
| `actName` | 当前环节名 |
| `startTime` | 当前环节开始时间 |
| `endTime` | 当前环节结束时间 |

当 `endTime` 不为 null 时按动态方式展示，当 `endTime` 为 null 时按历史方式展示

### [设置我关注的流程](#设置我关注的流程)
```
./microservice/workflownew/s/useSession/changeMyCaredProcdef?modelId=18046977115680768&modelId=80420087282003968
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `modelId`  | 流程对应模型的id，可出现多个 | long | 否 |
<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"RetVal":"关注成功"
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 1为成功，其它为失败 |
| `RetVal` | 显示给用户的语句 |

### [显示流程实例详情](#显示流程实例详情)
```
./microservice/workflownew/s/strictSession/showProcinstDetail?procInstId=81150796644741120
```
参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `procInstId`  | 查询流程实例id | long | 是 |
<b>需要登录</b>

返回结果如下：

```json
{
	"DataRows":{
		"actHiActinst":[{
			"actHiProcinst":{"$ref":"$.DataRows"},
			"actHiProcinstId":"81150796644741120",
			"actHiTaskinstId":"81150796699267073",
			"actId":"sendCorrection",
			"actName":"您有工位需要整改",
			"actReProcdefId":"reportReviewV2_1:6:81148978053246976",
			"actType":"userTask",
			"executionId":"81150796644741120",
			"id":"81150796699267072",
			"startTime":1565619857641,
			"tenantId":"69a6f974bb004a57a62523840bfecb2b"
		}],
		"actHiComment":[],
		"actHiTaskinst":[],
		"actHiVarinst":[],
		"id":"81150796644741120",
		"procInstId":"81150796644741120",
		"startActId":"startPosition",
		"startTime":1565619857629,
		"temp":{
			"status":"待处理"
		},
		"tenantId":"69a6f974bb004a57a62523840bfecb2b"
	},
	"RetCode":"1"
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `actHiActinst[0].actReProcdefId` | 流程名称:流程版本:流程定义id |
| `procInstId` | 流程实例id |
| `temp.status` | 流程状态 |
| `startTime` | 流程开始时间 |
| `actHiActinst[i].actName` | 当前环节名称（多个） |
| `actHiActinst[i].startTime` | 当前环节名称开始时间（多个） |

### [查询流程实例所有环节](#查询流程实例所有环节)
```
./microservice/workflownew/s/strictSession/showActinstAll?procInstId=81150796644741120
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `procInstId`  | 查询流程实例id | long | 是 |
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
| `actName`  | 环节准确名称 | String | 否 |
<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"actHiProcinstId":"81150796644741120",
			"actHiTaskinstId":"81150796699267073",
			"actId":"sendCorrection",
			"actName":"您有工位需要整改",
			"actReProcdefId":"reportReviewV2_1:6:81148978053246976",
			"actType":"userTask",
			"executionId":"81150796644741120",
			"id":"81150796699267072",
			"assignee":"ZhangSan",
			"startTime":1565619857641,
			"temp":{
				"action":"进行中"
			},
			"tenantId":"69a6f974bb004a57a62523840bfecb2b"
		},
		{
			"actHiProcinstId":"81150796644741120",
			"actId":"startPosition",
			"actName":"开始",
			"actReProcdefId":"reportReviewV2_1:6:81148978053246976",
			"actType":"startEvent",
			"duration":"11",
			"endTime":1565619857641,
			"executionId":"81150796644741120",
			"id":"81150796653129728",
			"startTime":1565619857630,
			"temp":{
				"action":"开始"
			},
			"tenantId":"69a6f974bb004a57a62523840bfecb2b"
		}
	],
	"pageNo":1,
	"pageSize":10,
	"totalCount":2
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `actName` | 环节名称，可为null |
| `actHiTaskinstId` | 任务id，可为null |
| `temp.action` | 环节状态 |
| `assignee` | 环节参与者，可为null |
| `startTime` | 任务开始时间 |
| `endTime` | 任务结束时间，可为null |

`endTime` 不为 `null` 时显示xx年xx月xx日xx时xx分xx秒，当鼠标放到上面时显示 “任务开始于xx年xx月xx日xx时xx分xx秒，结束于xx年xx月xx日xx时xx分xx秒”；`endTime` 为 `null` 时显示空白，当鼠标放到上面时显示 “任务开始于xx年xx月xx日xx时xx分xx秒”

### [查询指定任务的全部变量](#查询指定任务的全部变量)
```
./microservice/workflownew/s/strictSession/showVarinstByTask?taskId=82485163929366529
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `taskId`  | 查询任务id | long | 是 |
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"createTime":1565937995863,
			"executionId":"82485163904200704",
			"id":"82485165116354560",
			"lastUpdatedTime":1565937995863,
			"name":"kk",
			"procInstId":"82485163904200704",
			"rev":0,
			"taskId":"82485163929366529",
			"value":"vv",
			"varType":"string"
		},
		{
			"createTime":1565938146598,
			"executionId":"82485163904200704",
			"id":"82485797344768000",
			"lastUpdatedTime":1565938146598,
			"name":"selfInspection",
			"procInstId":"82485163904200704",
			"rev":0,
			"taskId":"82485163929366529",
			"value":"false1",
			"varType":"string"
		},
		{
			"createTime":1565938146668,
			"executionId":"82485163904200704",
			"id":"82485797638369280",
			"lastUpdatedTime":1565938146668,
			"name":"officerAgree",
			"procInstId":"82485163904200704",
			"rev":0,
			"taskId":"82485163929366529",
			"value":"true1",
			"varType":"string"
		}
	],
	"pageNo":1,
	"pageSize":10,
	"totalCount":3
}
```

主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `createTime` | 添加变量时间 |
| `executionId` | 对应的executionId |
| `id` | 变量id |
| `lastUpdatedTime` | 上次更新变量时间 |
| `name` | 变量名 |
| `procInstId` | 对应的procInstId |
| `taskId` | 对应的taskId |
| `value` | 变量值 |
| `varType` | 变量类型 |

### [查询指定流程实例的全部变量](#查询指定流程实例的全部变量)
```
./microservice/workflownew/s/strictSession/showVarinstByProcinst?procInstId=82485163904200704
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `procInstId`  | 查询流程实例id | long | 是 |
| `pageSize`  | 每页显示数量 | int | 否，默认为10 |
| `count`  | 当前页数 | int | 否，默认为1 |
<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"maxPageNum":1,
	"pageItems":[
		{
			"actHiTaskinst":{
				"actHiActinst":[],
				"actHiComment":[],
				"actHiVarinst":[{"$ref":"$.pageItems[0]"},{
					"actHiTaskinst":{"$ref":"$.pageItems[0].actHiTaskinst"},
					"createTime":1565938146598,
					"executionId":"82485163904200704",
					"id":"82485797344768000",
					"lastUpdatedTime":1565938146598,
					"name":"selfInspection",
					"procInstId":"82485163904200704",
					"rev":0,
					"taskId":"82485163929366529",
					"value":"false1",
					"varType":"string"
				},{
					"actHiTaskinst":{"$ref":"$.pageItems[0].actHiTaskinst"},
					"createTime":1565938146668,
					"executionId":"82485163904200704",
					"id":"82485797638369280",
					"lastUpdatedTime":1565938146668,
					"name":"officerAgree",
					"procInstId":"82485163904200704",
					"rev":0,
					"taskId":"82485163929366529",
					"value":"true1",
					"varType":"string"
				}],
				"deleteReason":"completed",
				"duration":"151209",
				"endTime":1565938146795,
				"executionId":"82485163904200704",
				"id":"82485163929366529",
				"name":"您有工位需要调整",
				"priority":50,
				"startTime":1565937995586,
				"taskDefKey":"sendCorrection",
				"tenantId":"b33d221d066e498881ad2086d897ffdd"
			},
			"createTime":1565937995863,
			"executionId":"82485163904200704",
			"id":"82485165116354560",
			"lastUpdatedTime":1565937995863,
			"name":"kk",
			"procInstId":"82485163904200704",
			"rev":0,
			"taskId":"82485163929366529",
			"value":"vv",
			"varType":"string"
		},
		{"$ref":"$.pageItems[0].actHiTaskinst.actHiVarinst[1]"},
		{"$ref":"$.pageItems[0].actHiTaskinst.actHiVarinst[2]"},
		{
			"actHiTaskinst":{
				"actHiActinst":[],
				"actHiComment":[],
				"actHiVarinst":[{"$ref":"$.pageItems[3]"},{
					"actHiTaskinst":{"$ref":"$.pageItems[3].actHiTaskinst"},
					"createTime":1565938283102,
					"executionId":"82485163904200704",
					"id":"82486369884041216",
					"lastUpdatedTime":1565938283102,
					"name":"officerAgree",
					"procInstId":"82485163904200704",
					"rev":0,
					"taskId":"82485798229766145",
					"value":"true",
					"varType":"string"
				}],
				"deleteReason":"completed",
				"duration":"136398",
				"endTime":1565938283207,
				"executionId":"82485163904200704",
				"id":"82485798229766145",
				"name":"安全员确认调整是否合格",
				"priority":50,
				"startTime":1565938146809,
				"taskDefKey":"officerJudge",
				"tenantId":"b33d221d066e498881ad2086d897ffdd"
			},
			"createTime":1565938283032,
			"executionId":"82485163904200704",
			"id":"82486369590439936",
			"lastUpdatedTime":1565938283032,
			"name":"selfInspection",
			"procInstId":"82485163904200704",
			"rev":0,
			"taskId":"82485798229766145",
			"value":"false",
			"varType":"string"
		},
		{"$ref":"$.pageItems[3].actHiTaskinst.actHiVarinst[1]"}
	],
	"pageNo":1,
	"pageSize":10,
	"totalCount":5
}
```

返回结果中带有自循环标志 `"$ref"`，需要用<b>Jsonx.format()</b>方法进行处理才能使用。主要属性说明如下：
                                                         
| 属性     | 说明   |
|:--------|:-------|
| `createTime` | 添加变量时间 |
| `executionId` | 对应的executionId |
| `id` | 变量id |
| `lastUpdatedTime` | 上次更新变量时间 |
| `name` | 变量名 |
| `procInstId` | 对应的procInstId |
| `taskId` | 对应的taskId |
| `value` | 变量值 |
| `varType` | 变量类型 |
| `actHiTaskinst.name` | 关联任务的名称 |
| `actHiTaskinst.taskDefKey` | 关联任务的标识 |
| `actHiTaskinst.id` | 关联任务的id |
