---
layout: post
title: 后端微服务文档
description: 本章内容为后端服务手册。
category: 工作流
date: 2017-12-02
list_number: false
---

## [租户](#租户)

### [租户列表](#租户列表)
服务地址：
```
http://10.0.209.147/microservice/workflownew/s/useSession/showTenantList?count=1&name=一
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `count`  | 页数 | int | 是 |
| `name`  | 租户名称 | String | 否 |

<b>需要登录</b>

返回结果如下：

```json
{
	"RetCode":"1",
	"RetVal":null,
	"maxPageNum":1,
	"pageItems":[
		{
			"activated":true,
			"code":"tenant11",
			"companyName":null,
			"createTime":1550628600000,
			"dataSourceConfig":null,
			"description":"这是第十一个租户",
			"id":"tb",
			"invite":[],
			"name":"租户二一",
			"tenantAccBuk":[]
		}
	],
	"pageNo":1,
	"pageSize":9,
	"totalCount":1
}
```

说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | <font color='red'>取值为0/1/2/3，其中1为正常，其它情况均为异常</font> |
| `RetVal` | <font color='red'>发生异常时的简单介绍</font> |
| `maxPageNum` | 最大页数 |
| `pageItems` | 页内容 |
| `pageNo` | 当前页码 |
| `pageSize` | 每页容量 |
| `totalCount` | 全部数量 |
| `activated`  | 是否启用，可能的返回值“0/1”，0 代表启用，1 代表禁用|
| `code` | 租户编码 |
| `companyName` | 不用管 |
| `createTime`     | 建立时间 |
| `dataSourceConfig`     | 不用管 |
| `description`     | 租户描述 |
| `id`     | 主键，独一无二 |
| `invite`  | 不用管 |
| `name`     | 租户名称 |
| `tenantAccBuk`     | 不用管 |

### [租户数据源信息](#租户数据源信息)
服务地址：
```
http://10.0.209.147/microservice/workflownew/s/useSession/showTenantSource?tenantId=t1
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `tenantId`  | 租户id | String | 是 |
<b>需要登录</b>

返回结果如下：

```
{
	"DataRows":{
		"code":"tenant2",
		"dataSourceConfig":{
			"minIdle":"1",
			"validationQuery":"select 1",
			"initialSize":"1",
			"maxWait":"60000",
			"filters":"stat",
			"poolPreparedStatements":"true",
			"type":"com.alibaba.druid.pool.DruidDataSource",
			"url":"jdbc:mysql://10.0.209.144:3306/myactiviti?useSSL=false",
			"useSSL":"false",
			"testWhileIdle":"true",
			"testOnBorrow":"false",
			"maxOpenPreparedStatements":"20",
			"timeBetweenEvictionRunsMillis":"60000",
			"minEvictableIdleTimeMillis":"300000",
			"testOnReturn":"false",
			"name":"testdb3",
			"maxActive":"20"
		},
		"id":"t12",
		"invite":[],
		"name":"租户一二",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":null
}
```

说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 具体内容 |
| `code` | 租户编码 |
| `id`     | 主键，独一无二 |
| `invite`  | 不用管 |
| `name`     | 租户名称 |
| `tenantAccBuk`     | 不用管 |
| `dataSourceConfig` | 数据源内容，内部属性不固定，按key和value的方式展示 |

### [新建租户基本信息](#新建租户基本信息)
服务地址：
```
http://10.0.209.147/microservice/workflownew/s/useSession/createTenantBasic?name=n&code=c&description=d&activated=true
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `name`  | 租户名称 | String | 是 |
| `code`  | 租户编号，需异步调用校验 | String | 是 |
| `description`  | 租户描述 | String | 是 |
| `activated`  | 是否启用 | boolean | 是 |
<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"DataRows":{
		"activated":true,
		"code":"a26",
		"createTime":1551357397690,
		"description":"asd",
		"id":"5800f1526a444a269620e7bb64fbb775",
		"invite":[],
		"name":"新7",
		"tenantAccBuk":[]
	},
	"RetCode":"1",
	"RetVal":"租户 新7:a26 新增成功"
}
失败时：
{
	"RetCode":"2",
	"RetVal":"租户 新7:a26 新增时发生异常：FindRepeatedTenantCode"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |
| `DataRows` | 正常时返回新增租户信息 |
| `code` | 租户编码 |
| `id`     | 租户主键，独一无二 |
| `name`     | 租户名称 |
| `createTime`     | 创建时间 |

### [检查租户编号是否可用](#检查租户编号是否可用)
服务地址：
```
http://10.0.209.147/microservice/workflownew/s/useSession/checkTenantCode?code=aa
```

参数说明：

| 属性     | 说明   | 接受类型  | 是否必填 |
|:--------|:-------|:-------|:-------|
| `code`  | 租户编号 | String | 是 |
<b>需要登录</b>

返回结果如下：

```
成功时：
{
	"RetCode":"1",
	"RetVal":""
}
失败时：
{
	"RetCode":"2",
	"RetVal":"租户编号已被使用"
}
```

主要属性说明如下：

| 属性     | 说明   |
|:--------|:-------|
| `RetCode` | 取值为0/1/2/3，其中1为正常，其它情况均为异常 |
| `RetVal` | 发生异常时的简单介绍 |